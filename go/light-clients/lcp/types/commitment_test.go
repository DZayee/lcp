package types

import (
	"bytes"
	"encoding/hex"
	"testing"
)

func TestStateCommitmentABI(t *testing.T) {
	var cases = []struct {
		input string
	}{
		{"0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006000000000000000000000000043652784a66795bc756499b05b56d51526c1547d00000000000000000000000000000000000000000000000000000000000002e0000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000000200000000000000001000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000016072bc33f981064cb8f541937675fbca8d12dd647d46b0b999f9d30603ebd017f7000000000000000000000000000000000000000000000000a7646809a53f70be000000000000000000000000000000000000000000000000b6947ee97cff34520a7afe7513a0b785607ef44a9d71baefe7fef6ef2c0db73d9bca4979dc022fea000000000000000000000000000000000000000000000000000000000000006f4666296c5e2220316b51297d2c4d353655456f6a777127432626303958527578444f6f6959673057523d75406f5a29546a2f6d57207945657d555a757a274b512d53752b557a416566413c60495f3e4c3e4f533275584f5a4132212d4e41622455217a6322616d305f776b503e6a2d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034636c69656e74732f30372d74656e6465726d696e742d343034383431313930383639353532353238302f636c69656e745479706500000000000000000000000000000000000000000000000000000000000000000000000000000000000000407ead83bb15c6326a428d88a1f5e4ab3ed7862a93cb686cb24cc9bf22e32a8a9e4936fdfe878596a0e25d504cf10ad8b08f7f8404ec0c92f792227e458b7e160c"},
		{"00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000ce2f6b39ed3691ad868528e7ec0c8df1901d270300000000000000000000000000000000000000000000000000000000000002a0000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000200000000000000001000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000120d0cd6f6ab29d7e33deeabd4815e782c882c83e332786191a7e4b8203121e413e000000000000000000000000000000000000000000000000d5caa7a04cb8d1aa00000000000000000000000000000000000000000000000078cfc58970d5ef5c0d44d12de04c332d4537bb5fd9e4ffe4895974be7236f28878eaae04dd625c6000000000000000000000000000000000000000000000000000000000000000216f2a754e487177245c2b336e485b3a7c7a466b60215475682f393e7333582a4867000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000035636c69656e74732f30372d74656e6465726d696e742d31343536343231313336393530393934393834332f636c69656e745479706500000000000000000000000000000000000000000000000000000000000000000000000000000000000040565459b5e6f86b7beda960ff2600c103dd891df5d55159e6c41a21a28ea4c4a2c77c9d5d7d397d2485028bb846161f64536430da8c459ce648057fe353f6b2e3"},
		{"00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000cedaf997aa3440a83739b452104e1602b2f016b3000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000002a00000000000000000000000000000000000000000000000000000000000000020000000000000000100000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001a0758fffbe29b5403c20f442dcd6530a11d754d0fa46cd1f214073d060c084d36f00000000000000000000000000000000000000000000000092ab3cd1ff2eff65000000000000000000000000000000000000000000000000d7f0931f9bd995dc61cc02bddb5744f55703ff625c3eb3c07dfc913aac4ea118f9cb35af674572f500000000000000000000000000000000000000000000000000000000000000bf3e602d36252d2140682456327a622f3e442f5b46453c67263741654f56672461234d454152534d3735593c7b7c7144625a25566e5550773c6b73656d43663f5f3b6958642c7b726f7d444d772d376c4c54226a343c6d6d6a61737d245c50676c543c574b3169344c4d743365495d32406e476349247b7c42543f703e5675503b392b704a4439243d2031597e7e5b3e4d7976406e3d56286036214277385f3b6d4566474f55514650215d7670742e4f22695c70575c2737454d762779243650000000000000000000000000000000000000000000000000000000000000000035636c69656e74732f30372d74656e6465726d696e742d31313733343837313633373532323437393730302f636c69656e745479706500000000000000000000000000000000000000000000000000000000000000000000000000000000000040976ec60e3783b46c67bc654a67077bb8115d2718e568c0f292c3c652612b7f2a5a8f161800de58edd8169543153a8a563b9aadf758651763dee9176d50d8ae7f"},
		{"00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000719213011a5922abf025f76290989f052243d1f8000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000002a00000000000000000000000000000000000000000000000000000000000000020000000000000000100000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001a01a27ccb1f3a65b2b36b198283e161e805c4e35f44c04b96cc6ddd8f8491d46a10000000000000000000000000000000000000000000000003f2bc71a0eff75dd0000000000000000000000000000000000000000000000003ee9c9f040a71f3b100ac82b84f6418e32741bee183a736d1217fa6aae44be0ab5dc15db9828113d00000000000000000000000000000000000000000000000000000000000000a329505f685f73696a356352507a51735b4c7c70367d3838743c54734d6a642979636c6563387368743d35572c2772792b22667b672c4e442c3b675056544e416533392c55775434652423767c3428383f2d33697b2c225d53785e5d45616e48232e37355860212e307c4026475e6753452968422f7b28482b783a263b3128245d626e236772722a35384e5e346d3957283660246c7726243e6527297e303c693e204f4600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000035636c69656e74732f30372d74656e6465726d696e742d31333732383436373536343436363337303732302f636c69656e745479706500000000000000000000000000000000000000000000000000000000000000000000000000000000000040947c0e5f0e3f0d63512125b8ee7d73efd44740e1554494e5aa9863882ddc9966b4e5da2ae649d3e8c41a91de3769cf9f5783841034a9ad3248a89b8ec85d57a3"},
		{"0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006000000000000000000000000008b39942c245ba51a624fd401065e5bee80b4c30000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000100000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000180f93dc8c28ba315ab9d416bffc7cb4efe2d9ceaf04973b53272e8c659c587ba91000000000000000000000000000000000000000000000000b15120d7dc7f68db000000000000000000000000000000000000000000000000a5882c23c6302c61856c8cf423bb3664ed7a0782e092b61cf5baff6317766ee851144cec049154e8000000000000000000000000000000000000000000000000000000000000009a5a41435c53516726773b4f69764652493a2f53664e557b66287570675e4f217c7928552734545c605a5d6b746f6a6d4b28585e7760224f3c7c723d2c3030375876627d41476e463b4a256d6d3f4f3f7840764c252c4636724b6c347c645447435b677b7c32274c4e4f2c455d2a4853325029586b4d6065354c374e4535765c473a734d3c654c3c7d753f4d3726645c74422d312746725b6c52670000000000000000000000000000000000000000000000000000000000000000000000000035636c69656e74732f30372d74656e6465726d696e742d31373538373432343537333433353132303035382f636c69656e745479706500000000000000000000000000000000000000000000000000000000000000000000000000000000000040ff549ab7d39d05be8f8f6706d0a8e590443e67915f76b7da86af439f69d0f9eeb42b6b803ea5cbfee60ebfbf4d2045446b2a5405c0501229703a7f9ad77a2b9e"},
		{"000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000600000000000000000000000004920b8b08a6dcb43c81a6b76395c0ec03ad7d57c00000000000000000000000000000000000000000000000000000000000002e0000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000000200000000000000001000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001602136acf5bc8808d0a2cf38be86be08ac42acaf9a36e5e9b0ce96055106d9bf3f000000000000000000000000000000000000000000000000ca0f52e9c258b8b200000000000000000000000000000000000000000000000026164b5560dee4d98e300b426a4412d8c5183b03db8f413a99255d5464228f316a30398408c1e24b000000000000000000000000000000000000000000000000000000000000007461453a44403a4e62644a5c27434e3c405e72707e23453e31534b2531212925215679782e5b66522743257b6e767a455d325f356d56407d2b43455b6d584574506021564e6e526968463968467974632c71285b4b714d3f58723657763663564b437d5c5539617d663b71644863747621666527330000000000000000000000000000000000000000000000000000000000000000000000000000000000000034636c69656e74732f30372d74656e6465726d696e742d393838353231383630303639393139363739362f636c69656e745479706500000000000000000000000000000000000000000000000000000000000000000000000000000000000000406f959a577c55214c61aaf4d798c4cdf79616d4177a2fbca7294a93a78d215260ddd50ddf8d3a5cfa1179b828a3d775e09f1f7a730c4b6822e6be6c53e44ad83b"},
		{"000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000600000000000000000000000008c20974e8986365aabac2af76d8eb2fae4433cfa000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000002a00000000000000000000000000000000000000000000000000000000000000020000000000000000100000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c9781b4b68c1bd800000000000000000000000000000000000000000000000073600a221233f24145d2b00f3c8036f979b0650087096779e0184671461d80a988fa6807b8254d9900000000000000000000000000000000000000000000000000000000000000b6737065572c5178682e2f5a616b4358292a3f7b6d582d2c4547694e372a2e417d4e6c573770785528372e7e492d23652d55753a3169395c48266f2a544772697c725769442c4a635f755b246c446d3738654d5e7e795e616a3b21245f643c7b4f243c352a52426f22734f4b7e752f7256645634463935404a6a3e5369212a6d3865734f27627c3273614f4a7b62716445547b5e77262553572d65494b444675425278364a44732568715940605d522a6f703171537d47000000000000000000000000000000000000000000000000000000000000000000000000000000000034636c69656e74732f30372d74656e6465726d696e742d323734323130313130363030313237383733372f636c69656e7454797065000000000000000000000000000000000000000000000000000000000000000000000000000000000000004054487a59a074af721f84d6995f9fc6c42cd2665df3910fba85f574b59f04091986547e173375bf770ffc342bb8746ca3abffbd7dd07c2ae4c1516275f900f55b"},
		{"00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000a661993265c2bce50da506e054dfbbc65701bca800000000000000000000000000000000000000000000000000000000000002c0000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000000200000000000000001000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000140a3ed36636fbfff388b90e86a64bc1e173afa029d73265cf4d99da0196e4fce5c000000000000000000000000000000000000000000000000dfee34aaca4e32110000000000000000000000000000000000000000000000008a9d77037775d0085cfcd6d23f30fea20889aff64431955b41b9345314de0b9837a658298108003e000000000000000000000000000000000000000000000000000000000000005062286b687727572022686e347d2d3e6b707e555e3046373d713c64416a7d4d4b392d7a5665287c667d387c2d2a6c76217a257d286b4a514f212e4572783421597251757e6c642762622c422950296d3a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034636c69656e74732f30372d74656e6465726d696e742d343935333237323238303637343339303135332f636c69656e745479706500000000000000000000000000000000000000000000000000000000000000000000000000000000000000401a3ad0408b1433112442aa573abb5c27c0b2f8ca1c51926928bc37e260e6c3ef0cb20e18572796fa0fb8f4a92e1051d7986b0c4ce7dae9d1dbd752cd6c12ad2f"},
		{"000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000600000000000000000000000006ea56ab54a79c04c99fba27ebd88eed4c61ce71500000000000000000000000000000000000000000000000000000000000002a0000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000200000000000000001000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001208fc40cb4d16df887d140c17d16619c8e88b53ca527194c1428e1f021bdc0c160000000000000000000000000000000000000000000000000441bef7f77d37002000000000000000000000000000000000000000000000000bdfcd4b0b4a07dea27e6fac45638ffb521d8da2216ed8c81ba41c3e51928f24c0e09342f5902840400000000000000000000000000000000000000000000000000000000000000262034522d757e652968346870636462433a457d2d2d4478597a5f7522397550603664572b473900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034636c69656e74732f30372d74656e6465726d696e742d323133353038323935303138343335323239382f636c69656e74547970650000000000000000000000000000000000000000000000000000000000000000000000000000000000000040d2259c60eeb7605f137b2ed335b39599a3d009ec843bb646e9d3b715a5e6a666dc005df2538d7720286743d057c9da5e461751665e362926e0716ebf3b7a9381"},
		{"0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006000000000000000000000000040de2871c27ef470f4fbdc232e22730e9bf1f9f6000000000000000000000000000000000000000000000000000000000000036000000000000000000000000000000000000000000000000000000000000002e00000000000000000000000000000000000000000000000000000000000000020000000000000000100000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000260000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f11d9c4d1368ef260000000000000000000000000000000000000000000000000e6897a5d7374d9fa7f01b91b5bd2af5ace9ad865e6a43323d5b0d4d5ec1a7ea3723527e0b03d63000000000000000000000000000000000000000000000000000000000000000ee75614e6160665f42535c353b603c6d3930607a5528685627675f627c2b7222786456747e2352497b21796a32784f515b674e6b56293d4b41504e3023797378444a4f7e2a51357e7b6c303969263f78785b585d432e296f482127512422535573745f23273143627628652d75245d23313a642b37784f51627c5f585771674c5831326a2a407227432f2e7b502120513969292b5a3d3856344c424e4561654b3d545a6f3b5633213b466c3f46693d766d645f5c50632f2f7c335b5e3174312c364b4d3c2238417e7442266659786348415e275e2578566e54435b34514a224b47777e6d705b234332464c6b5a60490000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034636c69656e74732f30372d74656e6465726d696e742d353437333636333934393932303731313133352f636c69656e74547970650000000000000000000000000000000000000000000000000000000000000000000000000000000000000040cb6b897fc542dc3ee67e5e05ed4fabc6a14dc40f9bebcb8620c48b6d685a4de733bd1e6b71e618fb0d07d7a3623520ce84cdea4db95887e7bf7d673ffc5bc056"},
	}

	for _, tc := range cases {
		bz, err := hex.DecodeString(tc.input)
		if err != nil {
			t.Fatal(err)
		}
		proof, err := EthABIDecodeCommitmentProof(bz)
		if err != nil {
			t.Fatal(err)
		}
		bz2, err := EthABIEncodeCommitmentProof(proof)
		if err != nil {
			t.Fatal(err)
		}
		if !bytes.Equal(bz, bz2) {
			t.Fatal("pack/unpack failed")
		}
		hc, err := EthABIDecodeHeaderedCommitment(proof.CommitmentBytes)
		if err != nil {
			t.Fatal(err)
		}
		_, err = hc.GetStateCommitment()
		if err != nil {
			t.Fatal(err)
		}
	}
}

func TestUpdateClientCommitmentABI(t *testing.T) {
	var cases = []struct {
		input string
	}{
		{"0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006000000000000000000000000038f89a093017df31dcd4b22295cd259508abc08600000000000000000000000000000000000000000000000000000000000002a0000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000200000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000ab6c6fc021d6b561ffd64401c42f8ec1aa9191ccae3eede03ad7082f26011d96000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a21db896fb29f366000000000000000000000000000000000000000000000000baeb94b853395ad800000000000000000000000000000000000000000000000017777c1b5c43d6e60000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004004923fe78a0e717d855588c6bbe4dcdc52cd477bf38d4650d7394df31f312f70954746817ad6e5569a50a8f7162bfa2ae543aeb8e8f8b3f5fa468d4b8622b84b"},
		{"0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006000000000000000000000000046b0c9ff9e3b8a1a954be7406c64fc1c4c89b60d00000000000000000000000000000000000000000000000000000000000003800000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000002000000000000000010000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000000200244e50123a98fac9b7a3e3275bbde4a173a421068e4aa40baebc4b9c1fafc03fdc2c2171e45c3268be2de0016c449cebdafaa84224c66c81d534b448bb9099b00000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099608a3a907520470000000000000000000000000000000000000000000000009a5e1286e0e49bac00000000000000000000000000000000000000000000000017777c1b5c44a2e1000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000cb0a012f12c501cf8f0ecbd6d1207aebaa5b62dff1c142e0f2ead69a2f4d302d9ee85b127c617a90ac29f030d5a3e95d230524139c22c85979b03d9441f9913ef75df78e5acb313ddaf6fbcac8b22bd14662185880f3e60c087a7399962a7030d30f24671e59e923a57fa990d531a97018179c2156b5ea00611b6c5c740541db460d28961ea022faf253ca381a8359343ede2e1c1266309e1584078f3c08de6903fa8c84c775a1bc7d310b37c88ec8b2b8c241db48763799717247e97af3745c38b1386e42f1e6cc13a1eaa6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040b8b9d11964ca97fdc819ffc7f764cb7b0f58002a02bbe457ef841b082307f70cd718ca05308b8a72d0685c2588c8cf6a8277df04e4ea920209979705b9ed588e"},
		{"000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000600000000000000000000000009771f2b542daa045cd2d26a5734368a32fcb434c0000000000000000000000000000000000000000000000000000000000000580000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000000200000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000004800000000000000000000000000000000000000000000000000000000000000020b4a9eecfbfa6639e340d1c158b84766a3011243f568f70c9b1691d7e6502185366e1ad8c9036f4e4af9476a7c4e4c7ea8b95f3dce3885810024384399a36fe150000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000b00674e3065ab9ca000000000000000000000000000000000000000000000000ccd9748a25a1e142000000000000000000000000000000000000000000000000fc733b9b1dac9d6700000000000000000000000000000000000000000000000000b2f522e14cea0300000000000000000000000000000000000000000000000017777c1b5c450a0a000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000000000000002cb0a012f12c505da120b09ee12c1921a8441539f7d33090b05ffdd6852b02503c417058f5a4f25bed5543e84786243c48da63d4d9b0b46aff1027a7a015c8f1afbf769abff100f0a5c0b18be9d58f1dcb0c3bba3607ebed304c80348d68eeaf374e987c72a0e60f73b3c795dc79963ceb2885fa0ce5c6be893c443b82ed4825e21c589db43c7148567ee0e93e156459bd140c64f91f720559f6fb3256c7d52f44383663fc364bfc4a9e1f0df76fe3558729dc8e91734c52e4fcb74e25238ced65c78d4912acec6c15745d66cb6806a8ca3954ae60d6e250aa952a94fb7cb9475c71275757785d03282929a693630303c31930940ade013d63e9d65ecc160f66066c2f97320f9d5561607bdc9688743453afb75907d0217fc55cf2a796afc264af0d2a38f7723d18a1666fdc57d760b9e8e82f6d59a3ebd1494813a2982b8038650cb644885504367261fa9f0acc9ef45f0cc931fe662f9f3a2e0bbbd538cf5cd0ba6c0b79b762ee6ad2c38f44c2e0b161db9915ec4f2e18e694622c94c7281d28a00be2a6668c0784b368719ea8fe607bf620d1357b3cce60e854b1b9b8867ce9198c16bf7827eb6564fc870fb2eb4b45f17fd976eb23d3f678bda63020af3a9adf1d307df3de0fdb45e5a3953efa2b7feaa5fdb666cfe006b454d0840863ea6667c8b8fd5362afa17c25f480f631ac4490bf1ccbed901b9447c9b1b43fc3310262cf7d5952907ca56c5e48169272d5d18710bce2523a2755a75691c9f746b857f59a776ea6bde2b9438be4af9dcce87933409235a51943e3457658cbf9790ca1152d8536521dc71c95f027e0ce529583a7651dd237bb6f4b32d77e8b9abc3480ba80b8ca948d7ec5105ffbbf1da4ddc0b64855af0d9c8c82fc436b709e6e58e657aa78aaa390f3ee6eed97e666187745bf9f1d7c6909dedc301f2e641dd90b48cc37aaaa5d28029bcc37ebe54227816338eea4d81cecbf0dba2a1a460dea1c2bcd21bca947528511d61f91500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004015152fff203deca27f0114e99554b1c795f2bc5e41028387d546c66d1d19b38302b84dc4a278f339adb4c820b989e445af15449d7ba4d936c9729c52d2c7d81e"},
		{"000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000600000000000000000000000005d53cd75da6dc1ef021191777dcd71d84915fa41000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000005e00000000000000000000000000000000000000000000000000000000000000020000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000560000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000007131939e6ee9df5f308a1b8d296f4bf25fa99df8d6214140a4f318e5fa84d651000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a379df221ad91b67000000000000000000000000000000000000000000000000955fcfe394af16f800000000000000000000000000000000000000000000000017777c1b5c45c940000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000003bd0a012f12b707a0122a5c3d846df3b9f5707ea2eaec06ee1013e48e37e84094cf16551a20068a80a4d48d3a994486d72221123cb5b00c45ba8779f98b1bae963ea4f2f583c865bb86847a0187114d041db53fc0afb505594ff642e289b45bb784ff932ecfe6c618c03055101a6d3d6fe4cb25738f0c4f8d9b790ec43d14f2d51d84da8c1be7512c9ac8998e9f4b1b5779e1d6724abab65d05bfd94c03350fbd08c542297295bd3c0edbb91fa740c831f9b2719f52b9d10ce0e3e212d4a8f3755077607799ddb82d2cd7796507c3c38c9ad287f540b016656f3256c5a5dfd3710e8b4060dfb8e33729a3b44d4e1272a658b1f27a511c09c7730991f0af3dee6c98171abf59ad5ae10a2a22fd5fd297e11b0cd300993848d4f152dee95275448122bd94772110bf973e3366e06c67c456496f2d41c7ee44dd78872cfebd56a44cdd7548fdfd50b0b1a91475738c4d5f86d714f98b98fabeaf07af62d25d54741ccdba77efda0a72a25899740e7a710984dd0a8c1f84208f4afb6db588a6257f82093e3711f3adba48279fbc085c8ba0aaf7526d91d088950717e6873c9340a5c19a4558bb2f67c9366e5c0e4f235273f146cb8759a9860cd020a696c7e1ca8f0a68e9f54d431a3e728326aba979e0131689f049b45b8e2d2b33cceeb22e7f71bfd5eca3ca84b30b0c54a93a6bc4e60d4dd443139354a7f025cddefe63542ceab14c2c3f4ba5351c9c624826ae3cf9d89699661991256f7eca2f29ddce2c856f9f4236f70732b9664149b2fafce84a57927f578c5008e92da1716406d9f6b618d80e5c77f0ebe796ff477b58d2144e1915fb62f81952ee559b8573d774ef1da66be0211735aebb5ed8195b27447a09383dfec0fb74e7e91b5e99792ab54f72e532dededc3542ed032426834a50729fb5d423277a76725700f84d870f2c9854544c534c87df58b556284be8a6c9d15adf25a77e7c55c8ddda1f598beb09b2cd20470a9b4a7afd9c53e4d83ff8d70d6c4c63ed54ade681e1e2f95011606c964e3e6edc398a6a7eb5bbbc5531fb5430a1f41776e7c637fcd244351230d8b15773382c85fde2f436852bbca56cde7feb0b7d08ef456a0e747dc44a88fe283350169810f9f6aefd07511eb7ab37919a4a76cea4bcdebbf3ef63ded4f040d9132680f83da6514dbd533a563a5e74e1b319f33bfdaeefcaad4feac8f4b252b1a83dde24938770bdad294e9dd0c3f909697c6bb62add1573d186dfa255a682a1bd0fb53dd05e0d111f66695abb2176224bcba344aedaeeb4053080a1c785d8018153fcfe1e10b625120991e7be5faeacf8f8e2f9f0a0450ba6e7c870c2e9f122c0db8d0000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000402e1c217418d0b31c5f2d4c1185da53ab4b0f88efc7f9c27b29ca5d5f89e91a31aeea11e41ab2e36b458896d8db6f50d440bf0c729d18ff8d1c9393f43c3460d4"},
		{"0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006000000000000000000000000045e415caf76b8cb117ebc77b7545014e943618da000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000000000000000000000000000003a00000000000000000000000000000000000000000000000000000000000000020000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000320000000000000000000000000000000000000000000000000000000000000002034e27ec98bbbadf845da5c42f3cc06a8389c9d9fecbb22a413f1b88ff6b4ccc7c757ac83f3354543168f7ccfb3409b88607213a75686e461d9c7ac7166e6684400000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000082baf27475d850790000000000000000000000000000000000000000000000001715684f54d1bd9300000000000000000000000000000000000000000000000017777c1b5c4688b700000000000000000000000000000000000000000000000000000000000002c0000000000000000000000000000000000000000000000000000000000000017a0a012f12f402e7d042193653ec2b62faa087a6e6d8b21dd712a7a58481982e34ddae3da72fb15cb20a4b644536354a109632000ef1c0a065fc0d39718f5fd72e5bbe9a266373d4be5b64ec20d77c48a8a6284a5afe6afbc3baad0999fb27680c31d2b6cdd5019c7956b7f5e5d0a1a8bacb6904bfbc1a600d5fe02fe25f05b89a8d1c9a89c97f42d6cd506c5e1553a93e0cdc2b89de39e9aebfe83b7c7ca32dd1214cefb2b0409175a9561743e52272e7d9df198140070ad0572feb25b369583355e1b4ee6282afdbb38e6055cc8c172f53339791dadaaf71b87cde9e6262852c645b9f12f6b89daa3175cd3c3efacd3a06f2c8c4074781650582352a17a2bfcf9200be360915b0c447ff887ef26667819aa2b12081e3c8f54f24bb2aff56cd501e00c8a33e6b43b049a24341f60dcd878247ac2ecb815d694e05bc135d932ac850da408edbda007af147151314ec63acb94387801e9237033fccb0104aada700f46688b2884c32da865c1e5e1b9058141cab78f1b7c91bf2e854000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040b4da336ad67e65c69fd97f88da105543ec7c171183be92ee7e3ee06992e1244fa63b41c78e925f0d24eff130cad1b0960e7352541dd67b79e6a4621cffde7ad3"},
		{"000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000600000000000000000000000006fc9a0b32dd942cdb1d4e6d9a528496138f660bc000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000100000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002009b2f878ad93a9499730047a9c0b57d87877a24df2570e65944d698de92ee285585a64deea9ac54b7f9885bed962f6b3ce70af56d579b85b624115f08b7964cf00000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000009c02858071bdb4cb0000000000000000000000000000000000000000000000009ff00eee2f270c2d000000000000000000000000000000000000000000000000061746c3f972f0ce000000000000000000000000000000000000000000000000a948a6568cf5f89900000000000000000000000000000000000000000000000017777c1b5c46e96600000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000000580a012f12530c351c60adcca339bd235b4d5d7dc32abb1ae51d0907f01103f580c5148335730c38d724b2a1d26b0ea32851093e8a824168552289af22b01f2ab0606b83d3a7f85de2f06fd1351e91c628a88c94c260b1f35900000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000401f4cb3cd14a6d2b3b399adceb9c6527fd476912df385689cb31cbdac0f223507dca8c86fdb7693265df587191e08366a745ba7e1ba8386a6325709119edb8e4f"},
		{"00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000beafe7de41017cc43fe29e2d4f9c00529559c52e00000000000000000000000000000000000000000000000000000000000002e0000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000000200000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000020da1ffaa4a84fd9abd39eb11b1df248c2f66a7d62a094c9bb3237173b2666aa8762527c96e647a43a36a08539451347125a8512307e95d8c4bf6c291bee017da1000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe5ea783bcae9ffd000000000000000000000000000000000000000000000000eadc0144edfdee9700000000000000000000000000000000000000000000000017777c1b5c472e760000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000003a0a012f12354cb784285902409b2b7f2258cb16c65129df8d9157e35749d915ec46b2e63d70a57094ac9c1328775ca705cbb7fbceddaae2a0984200000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004055f70ad998725ba69bcee16f336628c39a93e617296824a1f21c4fa85c36bc7af1c2a97ae41363b1140d807e7b445fc8c8b0f48f2351e80d0cbd4307ab8de3cd"},
		{"00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000774ea8fb15b283732acacb97337cfd24f77cfe3300000000000000000000000000000000000000000000000000000000000002a0000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000200000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000e578caf89b84e34f5332cf4911853100b489118f75b61fcba47377e9ce1aabb000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000041d9eb57e8ab41d5000000000000000000000000000000000000000000000000d8263fa2714efc6b00000000000000000000000000000000000000000000000017777c1b5c479a8900000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040f9aff7f6f52644aed3978ba6ec644e887efb229761369dcbe985a1d808d2500ceb678837541cf3504ebce87eaa453fe2bf995e232276b7f26e71f220a1b0c434"},
		{"000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000600000000000000000000000003e66c7af0a09736a1d44c042fcb71ef1a705fd9000000000000000000000000000000000000000000000000000000000000002a0000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000200000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000002092ad4b65e2612de7667a2b8a6decc369c9b854629131681e2d5c0a7b5c18f5bbbc8079d9ec16bf825ec781f420c939c2008d3c95abfdaf4ea14ca3846612a43c0000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004d1bd6573930b7830000000000000000000000000000000000000000000000003659ce4f7d738dac00000000000000000000000000000000000000000000000017777c1b5c480b0b00000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040010bf0c5b553f09b490082966852c04d426de6cd19b9a85000079e373cd1e61fda7893dbfd749b6529a0e2c48db6b27a357ded39152ac2978981b312784d453a"},
		{"00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000c45d015f5d33239508bfd21a6da442c63043431100000000000000000000000000000000000000000000000000000000000002a0000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000200000000000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000d071a638e0b1e6e3bf7311211d13a2caad0a1840afcaa109a9aeda404d499b2200000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000027284b0efd297445000000000000000000000000000000000000000000000000bfa248e2e941edbb00000000000000000000000000000000000000000000000017777c1b5c48474e000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000405ddc6ec9a5ed98f2a5effa328239c97246a2f6e13bb2147b49d48fce5df2e6969b2e0782bde8ab22bad8de3b5664d145f1743b3b82a53b5f87a3f644dbfe63c0"},
	}
	for _, tc := range cases {
		bz, err := hex.DecodeString(tc.input)
		if err != nil {
			t.Fatal(err)
		}
		proof, err := EthABIDecodeCommitmentProof(bz)
		if err != nil {
			t.Fatal(err)
		}
		bz2, err := EthABIEncodeCommitmentProof(proof)
		if err != nil {
			t.Fatal(err)
		}
		if !bytes.Equal(bz, bz2) {
			t.Fatal("pack/unpack failed")
		}
		hc, err := EthABIDecodeHeaderedCommitment(proof.CommitmentBytes)
		if err != nil {
			t.Fatal(err)
		}
		_, err = hc.GetUpdateClientCommitment()
		if err != nil {
			t.Fatal(err)
		}
	}
}
